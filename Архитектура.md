# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω–æ–≥–æ –≤–µ–±-—Ç–µ—Ä–º–∏–Ω–∞–ª–∞

## –û–±–∑–æ—Ä

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ **–∫–ª–∏–µ–Ω—Ç-—Å–µ—Ä–≤–µ—Ä** —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Go** –¥–ª—è backend –∏ **React** –¥–ª—è frontend. –°–µ—Ä–≤–µ—Ä–Ω–∞—è —á–∞—Å—Ç—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã–π —Ç–æ—Ä–≥–æ–≤—ã–π –±–æ—Ç, –∞ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∂–∏–º–µ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏.

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
arbitrage/
‚îú‚îÄ‚îÄ cmd/                         # –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ internal/                    # –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –ø–∞–∫–µ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ pkg/                         # –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îú‚îÄ‚îÄ migrations/                  # –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ frontend/                    # React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ docker-compose.yml           # Docker Compose –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ Dockerfile                   # Docker –æ–±—Ä–∞–∑
‚îú‚îÄ‚îÄ go.mod                       # Go –º–æ–¥—É–ª–∏
‚îî‚îÄ‚îÄ go.sum                       # –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—É–º–º—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
```

---

## üìÅ cmd/ - –¢–æ—á–∫–∏ –≤—Ö–æ–¥–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### cmd/server/main.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–ª–∞–≤–Ω–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- –ó–∞–ø—É—Å–∫ HTTP/HTTPS —Å–µ—Ä–≤–µ—Ä–∞
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è WebSocket hub
- –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –¥–≤–∏–∂–∫–∞ –±–æ—Ç–∞ (engine)
- Graceful shutdown –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç—ã
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üìÅ internal/ - –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### üìÅ internal/api/ - REST API

#### internal/api/handlers/
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** HTTP –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è REST API endpoints.

**–§–∞–π–ª—ã:**

##### exchange_handler.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `POST /api/exchanges/{name}/connect` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏—Ä–∂–∏ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ API –∫–ª—é—á–µ–π)
- `DELETE /api/exchanges/{name}/connect` - –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –±–∏—Ä–∂–∏
- `GET /api/exchanges` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –±–∏—Ä–∂ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
- `GET /api/exchanges/{name}/balance` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –±–∏—Ä–∂–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è API –∫–ª—é—á–µ–π —á–µ—Ä–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∏—Ä–∂–∞–º

##### pair_handler.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `POST /api/pairs` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Ç–æ—Ä–≥–æ–≤–æ–π –ø–∞—Ä—ã
- `GET /api/pairs` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤—Å–µ—Ö –ø–∞—Ä
- `GET /api/pairs/{id}` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –ø–∞—Ä—ã
- `PATCH /api/pairs/{id}` - —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ø–∞—Ä—ã
- `DELETE /api/pairs/{id}` - —É–¥–∞–ª–µ–Ω–∏–µ –ø–∞—Ä—ã
- `POST /api/pairs/{id}/start` - –∑–∞–ø—É—Å–∫ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø–∞—Ä—ã
- `POST /api/pairs/{id}/pause` - –ø—Ä–∏–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä—ã
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (—Å–ø—Ä–µ–¥—ã, –æ–±—ä–µ–º—ã, –ª–∏–º–∏—Ç—ã)

##### notification_handler.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `GET /api/notifications` - –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `GET /api/notifications?types=open,close,error` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º
- `DELETE /api/notifications` - –æ—á–∏—Å—Ç–∫–∞ –∂—É—Ä–Ω–∞–ª–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å–æ–±—ã—Ç–∏–π)

##### stats_handler.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `GET /api/stats` - –ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- `GET /api/stats/top-pairs` - —Ç–æ–ø-5 –ø–∞—Ä –ø–æ —Ä–∞–∑–Ω—ã–º –º–µ—Ç—Ä–∏–∫–∞–º
- `POST /api/stats/reset` - —Å–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–æ–≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º (–¥–µ–Ω—å/–Ω–µ–¥–µ–ª—è/–º–µ—Å—è—Ü)

##### blacklist_handler.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `GET /api/blacklist` - –ø–æ–ª—É—á–µ–Ω–∏–µ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞ –ø–∞—Ä
- `POST /api/blacklist` - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—ã –≤ —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
- `DELETE /api/blacklist/{symbol}` - —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ —á–µ—Ä–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞
- –°–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ —Ç–æ—Ä–≥–æ–≤–ª—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)

##### settings_handler.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `GET /api/settings` - –ø–æ–ª—É—á–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `PATCH /api/settings` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: max concurrent trades, notification preferences, funding consideration

#### internal/api/middleware/
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤.

**–§–∞–π–ª—ã:**

##### auth.go
**–§—É–Ω–∫—Ü–∏–∏:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–æ–≤ –∏–ª–∏ —Å–µ—Å—Å–∏–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –ó–∞—â–∏—Ç–∞ API endpoints –æ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- Rate limiting –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –∑–ª–æ—É–ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–π

##### logging.go
**–§—É–Ω–∫—Ü–∏–∏:**
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- –ó–∞–ø–∏—Å—å IP –∞–¥—Ä–µ—Å–æ–≤, –º–µ—Ç–æ–¥–æ–≤, –ø—É—Ç–µ–π, —Å—Ç–∞—Ç—É—Å-–∫–æ–¥–æ–≤
- –ò–∑–º–µ—Ä–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (JSON —Ñ–æ—Ä–º–∞—Ç)

##### cors.go
**–§—É–Ω–∫—Ü–∏–∏:**
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CORS –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –æ—Ç frontend –¥–æ–º–µ–Ω–∞
- –û–±—Ä–∞–±–æ—Ç–∫–∞ preflight –∑–∞–ø—Ä–æ—Å–æ–≤ (OPTIONS)
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è production

##### recovery.go
**–§—É–Ω–∫—Ü–∏–∏:**
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–∞–Ω–∏–∫–∏ –≤ handlers
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ stack trace
- –í–æ–∑–≤—Ä–∞—Ç 500 Internal Server Error
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø–∞–¥–µ–Ω–∏—è –≤—Å–µ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

#### internal/api/routes.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö HTTP –º–∞—Ä—à—Ä—É—Ç–æ–≤.

**–§—É–Ω–∫—Ü–∏–∏:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã URL endpoints
- –ü—Ä–∏–≤—è–∑–∫–∞ handlers –∫ –º–∞—Ä—à—Ä—É—Ç–∞–º
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ middleware –∫ –≥—Ä—É–ø–ø–∞–º –º–∞—Ä—à—Ä—É—Ç–æ–≤
- –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è API (v1, v2)

---

### üìÅ internal/websocket/ - WebSocket –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—è

#### internal/websocket/hub.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π.

**–§—É–Ω–∫—Ü–∏–∏:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –∞–∫—Ç–∏–≤–Ω—ã–º–∏ WebSocket –∫–ª–∏–µ–Ω—Ç–∞–º–∏
- Broadcast —Å–æ–æ–±—â–µ–Ω–∏–π –≤—Å–µ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã–º –∫–ª–∏–µ–Ω—Ç–∞–º
- –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è/–æ—Ç–º–µ–Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ —Ç–∏–ø–∞–º (pairUpdate, notification, balanceUpdate)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–µ—Ä–µ–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
- –û—á–∏—Å—Ç–∫–∞ –æ—Ç–∫–ª—é—á–µ–Ω–Ω—ã—Ö —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

**–¢–∏–ø—ã —Å–æ–æ–±—â–µ–Ω–∏–π:**
- `pairUpdate` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∞—Ä—ã (—Ü–µ–Ω—ã, PNL, —Å–ø—Ä–µ–¥)
- `notification` - –Ω–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
- `balanceUpdate` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –±–∏—Ä–∂–∏
- `statsUpdate` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

#### internal/websocket/client.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ WebSocket –∫–ª–∏–µ–Ω—Ç–∞.

**–§—É–Ω–∫—Ü–∏–∏:**
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–º —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ–º –∫–ª–∏–µ–Ω—Ç–∞
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –∫–ª–∏–µ–Ω—Ç—É
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞
- Ping/Pong –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∂–∏–≤–æ—Å—Ç–∏ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
- –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –∏—Å—Ö–æ–¥—è—â–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- Graceful –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

---

### üìÅ internal/bot/ - –õ–æ–≥–∏–∫–∞ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω–æ–≥–æ –±–æ—Ç–∞

#### internal/bot/engine.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–æ–π –¥–≤–∏–∂–æ–∫ –±–æ—Ç–∞, —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –≤—Å–µ–º —Ü–∏–∫–ª–æ–º —Ä–∞–±–æ—Ç—ã.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ì–ª–∞–≤–Ω—ã–π event loop –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º, –≤—Ö–æ–¥–æ–º –∏ —Å–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ–º –ø–æ–∑–∏—Ü–∏–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ –ø–∞—Ä (state machine transitions)
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–æ–≤ –±–∏—Ä–∂ (–∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π (shutdown, pause all)
- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤ –º–µ–∂–¥—É –ø–∞—Ä–∞–º–∏
- –°–æ–±–ª—é–¥–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∞—Ä–±–∏—Ç—Ä–∞–∂–µ–π

#### internal/bot/arbitrage.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –ø—Ä–∏–Ω—è—Ç–∏—è —Ä–µ—à–µ–Ω–∏–π –æ–± –∞—Ä–±–∏—Ç—Ä–∞–∂–µ.

**–§—É–Ω–∫—Ü–∏–∏:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∞—Ä–±–∏—Ç—Ä–∞–∂–Ω—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π (–∫–∞–∫–∏–µ –±–∏—Ä–∂–∏, –∫–∞–∫–æ–π —Å–ø—Ä–µ–¥)
- –í—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–π –ø–∞—Ä—ã –±–∏—Ä–∂ –¥–ª—è –∞—Ä–±–∏—Ç—Ä–∞–∂–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –≤—Ö–æ–¥–∞ (—Å–ø—Ä–µ–¥ ‚â• –ø–æ—Ä–æ–≥–∞, –º–∞—Ä–∂–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –≤—ã—Ö–æ–¥–∞ (—Å–ø—Ä–µ–¥ ‚â§ –ø–æ—Ä–æ–≥–∞ –≤—ã—Ö–æ–¥–∞, SL, liquidation)
- –õ–æ–≥–∏–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –≤—Ö–æ–¥–∞ (—Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞ N –æ—Ä–¥–µ—Ä–æ–≤)
- –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ—Ç–∫—Ä—ã—Ç–∏—è/–∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–µ–π—Å–∞ "–≤—Ç–æ—Ä–∞—è –Ω–æ–≥–∞ –Ω–µ –æ—Ç–∫—Ä—ã–ª–∞—Å—å"

#### internal/bot/spread.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–∞—Å—á–µ—Ç —Å–ø—Ä–µ–¥–∞ —Å —É—á–µ—Ç–æ–º –≤—Å–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö —Ü–µ–Ω —Å–æ –≤—Å–µ—Ö –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –±–∏—Ä–∂
- –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞–∫–∞–Ω–∞ –æ—Ä–¥–µ—Ä–æ–≤ (orderbook depth) –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω–æ–π —Ü–µ–Ω—ã
- –ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è –æ—Ä–¥–µ—Ä–∞ –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–º–∞
- –†–∞—Å—á–µ—Ç –±–∞–∑–æ–≤–æ–≥–æ —Å–ø—Ä–µ–¥–∞: `(P_high - P_low) / P_low √ó 100`
- –£—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π —Ç–µ–π–∫–µ—Ä–∞ –Ω–∞ –æ–±–µ–∏—Ö –±–∏—Ä–∂–∞—Ö
- –†–∞—Å—á–µ—Ç —á–∏—Å—Ç–æ–≥–æ —Å–ø—Ä–µ–¥–∞ (net spread) –ø–æ—Å–ª–µ –∫–æ–º–∏—Å—Å–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ –ª–∏–∫–≤–∏–¥–Ω–æ—Å—Ç–∏ –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–º–∞
- –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å—Ç–∞–∫–∞–Ω–æ–≤ –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–µ—Ä–∂–µ–∫

#### internal/bot/order.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ä–¥–µ—Ä–æ–≤ –Ω–∞ –±–∏—Ä–∂–∞—Ö.

**–§—É–Ω–∫—Ü–∏–∏:**
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä—ã–Ω–æ—á–Ω—ã—Ö –æ—Ä–¥–µ—Ä–æ–≤ (market orders)
- –û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ä–¥–µ—Ä–æ–≤ –Ω–∞ –¥–≤–µ –±–∏—Ä–∂–∏ (–∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ)
- –û–∂–∏–¥–∞–Ω–∏–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ä–µ–¥–Ω–µ–π —Ü–µ–Ω—ã –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è (fill price)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
- Retry logic –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–æ–≤ –æ—Ä–¥–µ—Ä–æ–≤ (min/max limits –±–∏—Ä–∂–∏)
- –û–∫—Ä—É–≥–ª–µ–Ω–∏–µ –æ–±—ä–µ–º–æ–≤ –¥–æ lot size –±–∏—Ä–∂–∏

#### internal/bot/position.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–ø—Ä–æ–≤–æ–∂–¥–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ù–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö —Ü–µ–Ω –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ unrealized PNL
- –†–∞—Å—á–µ—Ç –Ω–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞ –ø–æ –∫–∞–∂–¥–æ–π –Ω–æ–≥–µ
- –°—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ PNL –æ–±–µ–∏—Ö –Ω–æ–≥ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞
- –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–ø—Ä–µ–¥–∞ –º–µ–∂–¥—É –ø–æ–∑–∏—Ü–∏—è–º–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ WebSocket (–∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π

#### internal/bot/risk.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–∞–º–∏ –∏ –∑–∞—â–∏—Ç–∞ –∫–∞–ø–∏—Ç–∞–ª–∞.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ Stop Loss: –ø—Ä–æ–≤–µ—Ä–∫–∞ `PNL ‚â§ -SL`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ SL
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–π —á–µ—Ä–µ–∑ WebSocket –±–∏—Ä–∂–∏
- –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ –≤—Ç–æ—Ä–æ–π –Ω–æ–≥–∏ –ø—Ä–∏ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏ –ø–µ—Ä–≤–æ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä—ã –Ω–∞ –ø–∞—É–∑—É –ø–æ—Å–ª–µ SL/–ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞—Ä–∂–∏–Ω–∞–ª—å–Ω—ã—Ö —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–µ—Ä–µ–¥ –≤—Ö–æ–¥–æ–º
- –†–∞—Å—á–µ—Ç margin requirement –¥–ª—è –ø–æ–∑–∏—Ü–∏–∏
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–π –ø—Ä–∏ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–π –º–∞—Ä–∂–µ
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö

#### internal/bot/recovery.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ß—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–∞—Ä –∏–∑ –ë–î –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ –±–∏—Ä–∂–∞–º (API —Å–µ—Å—Å–∏–∏)
- –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π –Ω–∞ –±–∏—Ä–∂–∞—Ö —á–µ—Ä–µ–∑ API
- –ü–æ–ø—ã—Ç–∫–∞ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–∑–∏—Ü–∏–π, –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—â–∏—Ö –±–æ—Ç—É
- –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ runtime —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–∞—Ä
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ –Ω–∞–π–¥–µ–Ω–Ω—ã—Ö –ø–æ–∑–∏—Ü–∏—è—Ö
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ "–ø–æ—Ç–µ—Ä—è–Ω–Ω—ã—Ö" –ø–æ–∑–∏—Ü–∏–π
- –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä

#### internal/bot/state_machine.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–∞—Ä—ã.

**–§—É–Ω–∫—Ü–∏–∏:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –ø–∞—Ä—ã
  - `PAUSED` - –ø–∞—Ä–∞ –Ω–∞ –ø–∞—É–∑–µ
  - `READY` - –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–∫—Ç–∏–≤–µ–Ω, –æ–∂–∏–¥–∞–Ω–∏–µ —É—Å–ª–æ–≤–∏–π
  - `ENTERING` - –ø—Ä–æ—Ü–µ—Å—Å –≤—Ö–æ–¥–∞ –≤ –ø–æ–∑–∏—Ü–∏—é
  - `HOLDING` - –ø–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞, –æ–∂–∏–¥–∞–Ω–∏–µ –≤—ã—Ö–æ–¥–∞
  - `EXITING` - –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏
  - `ERROR` - –æ—à–∏–±–∫–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–æ
- –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –º–µ–∂–¥—É —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏–π (spread –¥–æ—Å—Ç–∏–≥–Ω—É—Ç, SL —Å—Ä–∞–±–æ—Ç–∞–ª, –æ—à–∏–±–∫–∞ API)
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

### üìÅ internal/exchange/ - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∏—Ä–∂–∞–º–∏

#### internal/exchange/interface.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ª—é–±–æ–π –±–∏—Ä–∂–µ–π.

**–§—É–Ω–∫—Ü–∏–∏:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–±—â–µ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `Exchange` –¥–ª—è –≤—Å–µ—Ö –±–∏—Ä–∂
- –ú–µ—Ç–æ–¥—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:
  - `Connect(apiKey, secret string) error` - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∏—Ä–∂–µ
  - `GetBalance() (float64, error)` - –ø–æ–ª—É—á–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
  - `GetTicker(symbol string) (Ticker, error)` - —Ç–µ–∫—É—â–∞—è —Ü–µ–Ω–∞
  - `GetOrderBook(symbol, depth int) (OrderBook, error)` - —Å—Ç–∞–∫–∞–Ω –æ—Ä–¥–µ—Ä–æ–≤
  - `PlaceMarketOrder(symbol, side string, qty float64) (Order, error)` - —Ä—ã–Ω–æ—á–Ω—ã–π –æ—Ä–¥–µ—Ä
  - `GetOpenPositions() ([]Position, error)` - –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏
  - `ClosePosition(symbol, side string, qty float64) error` - –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–∏
  - `SubscribeTicker(symbol string, callback func(Ticker))` - –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Ü–µ–Ω—ã (WS)
  - `GetTradingFee(symbol string) (float64, error)` - –∫–æ–º–∏—Å—Å–∏—è —Ç–µ–π–∫–µ—Ä–∞
  - `GetLimits(symbol string) (Limits, error)` - –ª–∏–º–∏—Ç—ã –±–∏—Ä–∂–∏ (min/max)
- –û–±—â–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö (Ticker, OrderBook, Order, Position)

#### internal/exchange/bybit.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –±–∏—Ä–∂–∏ Bybit.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `Exchange`
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã —Å Bybit API v5
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ–¥–ø–∏—Å—å HMAC)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –¥–∞–Ω–Ω—ã—Ö Bybit
- WebSocket –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ —Ñ—å—é—á–µ—Ä—Å–Ω—ã–µ —Ç–∏–∫–µ—Ä—ã
- –ú–∞–ø–ø–∏–Ω–≥ —Å–∏–º–≤–æ–ª–æ–≤ (BTC/USDT ‚Üí BTCUSDT)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ Bybit API
- Rate limiting –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏ Bybit

#### internal/exchange/bitget.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –±–∏—Ä–∂–∏ Bitget.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `Exchange` –¥–ª—è Bitget
- –†–∞–±–æ—Ç–∞ —Å Bitget Futures API
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø–æ–¥–ø–∏—Å—å –∑–∞–ø—Ä–æ—Å–æ–≤
- WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è –¥–ª—è real-time –¥–∞–Ω–Ω—ã—Ö
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã Bitget (productType, marginCoin)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤ Bitget
- Rate limiting

#### internal/exchange/okx.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –±–∏—Ä–∂–∏ OKX.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `Exchange` –¥–ª—è OKX
- –†–∞–±–æ—Ç–∞ —Å OKX Futures API
- Passphrase –≤ –¥–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∫ API key/secret
- WebSocket –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∫–∞–Ω–∞–ª—ã (ticker, orderbook)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ inst-type (SWAP –¥–ª—è —Ñ—å—é—á–µ—Ä—Å–æ–≤)
- –°–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –∫–æ–¥—ã –æ—à–∏–±–æ–∫ OKX
- Rate limiting

#### internal/exchange/gate.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –±–∏—Ä–∂–∏ Gate.io.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `Exchange` –¥–ª—è Gate
- –†–∞–±–æ—Ç–∞ —Å Gate.io Futures API
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –ø–æ–¥–ø–∏—Å—å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ settle –≤ USDT
- WebSocket –ø–æ–¥–ø–∏—Å–∫–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ Gate
- Rate limiting

#### internal/exchange/htx.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –±–∏—Ä–∂–∏ HTX (Huobi).

**–§—É–Ω–∫—Ü–∏–∏:**
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `Exchange` –¥–ª—è HTX
- –†–∞–±–æ—Ç–∞ —Å HTX Linear Swaps API
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (signature method)
- –ú–∞–ø–ø–∏–Ω–≥ —Å–∏–º–≤–æ–ª–æ–≤ –Ω–∞ HTX —Ñ–æ—Ä–º–∞—Ç
- WebSocket –¥–ª—è market data
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º–∞—Ç–æ–≤ HTX
- Rate limiting

#### internal/exchange/bingx.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –±–∏—Ä–∂–∏ BingX.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ò–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ `Exchange` –¥–ª—è BingX
- –†–∞–±–æ—Ç–∞ —Å BingX Perpetual Futures API
- –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- WebSocket subscriptions
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ BingX
- –ú–∞–ø–ø–∏–Ω–≥ —Å–∏–º–≤–æ–ª–æ–≤
- Rate limiting

#### internal/exchange/factory.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –§–∞–±—Ä–∏–∫–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –±–∏—Ä–∂.

**–§—É–Ω–∫—Ü–∏–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –±–∏—Ä–∂–∏ –ø–æ –∏–º–µ–Ω–∏: `NewExchange(name string) (Exchange, error)`
- –°–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –±–∏—Ä–∂
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
- –£–ø—Ä–æ—â–µ–Ω–∏–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –±–∏—Ä–∂

---

### üìÅ internal/models/ - –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö

#### internal/models/exchange_account.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–æ–¥–µ–ª—å –±–∏—Ä–∂–µ–≤–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```go
type ExchangeAccount struct {
    ID          int       `json:"id"`
    Name        string    `json:"name"`           // bybit, bitget, okx, gate, htx, bingx
    APIKey      string    `json:"-"`              // –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω, –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ JSON
    SecretKey   string    `json:"-"`              // –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω
    Passphrase  string    `json:"-"`              // –¥–ª—è OKX
    Connected   bool      `json:"connected"`
    Balance     float64   `json:"balance"`        // equity –≤ USDT
    LastError   string    `json:"last_error,omitempty"`
    UpdatedAt   time.Time `json:"updated_at"`
    CreatedAt   time.Time `json:"created_at"`
}
```

#### internal/models/pair.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤–æ–π –ø–∞—Ä—ã (PairConfig).

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```go
type PairConfig struct {
    ID              int       `json:"id"`
    Symbol          string    `json:"symbol"`          // BTCUSDT
    Base            string    `json:"base"`            // BTC
    Quote           string    `json:"quote"`           // USDT
    EntrySpreadPct  float64   `json:"entry_spread"`    // % –¥–ª—è –≤—Ö–æ–¥–∞
    ExitSpreadPct   float64   `json:"exit_spread"`     // % –¥–ª—è –≤—ã—Ö–æ–¥–∞
    VolumeAsset     float64   `json:"volume"`          // –æ–±—ä–µ–º –≤ –º–æ–Ω–µ—Ç–∞—Ö
    NOrders         int       `json:"n_orders"`        // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å—Ç–µ–π
    StopLoss        float64   `json:"stop_loss"`       // –≤ USDT
    Status          string    `json:"status"`          // paused, active
    TradesCount     int       `json:"trades_count"`    // –ª–æ–∫–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    TotalPnl        float64   `json:"total_pnl"`       // –ª–æ–∫–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    CreatedAt       time.Time `json:"created_at"`
    UpdatedAt       time.Time `json:"updated_at"`
}
```

#### internal/models/pair_runtime.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Runtime —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–∞—Ä—ã.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```go
type PairRuntime struct {
    PairID          int       `json:"pair_id"`
    State           string    `json:"state"`           // PAUSED, READY, ENTERING, HOLDING, EXITING
    Legs            []Leg     `json:"legs"`            // –æ—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ–∑–∏—Ü–∏–∏
    FilledParts     int       `json:"filled_parts"`    // —Å–∫–æ–ª—å–∫–æ —á–∞—Å—Ç–µ–π —É–∂–µ –≤–æ—à–ª–æ
    CurrentSpread   float64   `json:"current_spread"`  // —Ç–µ–∫—É—â–∏–π —Å–ø—Ä–µ–¥ %
    UnrealizedPnl   float64   `json:"unrealized_pnl"`  // –Ω–µ—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PNL
    RealizedPnl     float64   `json:"realized_pnl"`    // —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–π PNL
    LastUpdate      time.Time `json:"last_update"`
}

type Leg struct {
    Exchange      string    `json:"exchange"`
    Side          string    `json:"side"`            // long, short
    EntryPrice    float64   `json:"entry_price"`
    CurrentPrice  float64   `json:"current_price"`
    Quantity      float64   `json:"quantity"`
    UnrealizedPnl float64   `json:"unrealized_pnl"`
}
```

#### internal/models/order.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–ø–∏—Å—å –æ–± –æ—Ä–¥–µ—Ä–µ.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```go
type OrderRecord struct {
    ID            int       `json:"id"`
    PairID        int       `json:"pair_id"`
    Exchange      string    `json:"exchange"`
    Side          string    `json:"side"`            // buy, sell, long, short
    Type          string    `json:"type"`            // market
    PartIndex     int       `json:"part_index"`      // –∏–Ω–¥–µ–∫—Å —á–∞—Å—Ç–∏ (–ø—Ä–∏ —Ä–∞–∑–±–∏–µ–Ω–∏–∏)
    Quantity      float64   `json:"quantity"`
    PriceAvg      float64   `json:"price_avg"`       // —Å—Ä–µ–¥–Ω—è—è —Ü–µ–Ω–∞ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏—è
    Status        string    `json:"status"`          // filled, cancelled, rejected
    ErrorMessage  string    `json:"error_message,omitempty"`
    CreatedAt     time.Time `json:"created_at"`
    FilledAt      time.Time `json:"filled_at,omitempty"`
}
```

#### internal/models/notification.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ —Å–æ–±—ã—Ç–∏–∏.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```go
type Notification struct {
    ID        int                    `json:"id"`
    Timestamp time.Time              `json:"timestamp"`
    Type      string                 `json:"type"`      // OPEN, CLOSE, SL, LIQUIDATION, ERROR, MARGIN, PAUSE, SECOND_LEG_FAIL
    Severity  string                 `json:"severity"`  // info, warn, error
    PairID    int                    `json:"pair_id,omitempty"`
    Message   string                 `json:"message"`
    Meta      map[string]interface{} `json:"meta,omitempty"` // –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
}
```

**–¢–∏–ø—ã —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π:**
- `OPEN` - –æ—Ç–∫—Ä—ã—Ç–∏–µ –∞—Ä–±–∏—Ç—Ä–∞–∂–∞
- `CLOSE` - –∑–∞–∫—Ä—ã—Ç–∏–µ –ø–æ–∑–∏—Ü–∏–π
- `SL` - —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–µ Stop Loss
- `LIQUIDATION` - –ª–∏–∫–≤–∏–¥–∞—Ü–∏—è –ø–æ–∑–∏—Ü–∏–∏
- `ERROR` - –æ—à–∏–±–∫–∞ API/–æ—Ä–¥–µ—Ä–∞
- `MARGIN` - –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –º–∞—Ä–∂–∏
- `PAUSE` - –ø–∞—É–∑–∞/–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä—ã
- `SECOND_LEG_FAIL` - –Ω–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –≤—Ç–æ—Ä—É—é –Ω–æ–≥—É

#### internal/models/settings.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–æ—Ç–∞.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```go
type Settings struct {
    ID                   int                       `json:"id"`
    ConsiderFunding      bool                      `json:"consider_funding"`      // —É—á–∏—Ç—ã–≤–∞—Ç—å —Ñ–∞–Ω–¥–∏–Ω–≥ (future)
    MaxConcurrentTrades  *int                      `json:"max_concurrent_trades"` // null = –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
    NotificationPrefs    NotificationPreferences   `json:"notification_prefs"`
    UpdatedAt            time.Time                 `json:"updated_at"`
}

type NotificationPreferences struct {
    Open          bool `json:"open"`
    Close         bool `json:"close"`
    StopLoss      bool `json:"stop_loss"`
    Liquidation   bool `json:"liquidation"`
    APIError      bool `json:"api_error"`
    Margin        bool `json:"margin"`
    Pause         bool `json:"pause"`
    SecondLegFail bool `json:"second_leg_fail"`
}
```

#### internal/models/blacklist.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```go
type BlacklistEntry struct {
    ID        int       `json:"id"`
    Symbol    string    `json:"symbol"`     // BTCUSDT
    Reason    string    `json:"reason"`     // –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –∑–∞–º–µ—Ç–∫–∞
    CreatedAt time.Time `json:"created_at"`
}
```

**–§—É–Ω–∫—Ü–∏–∏:**
- –°–ø—Ä–∞–≤–æ—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ (–Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –ª–æ–≥–∏–∫—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–º–µ—á–∞–µ—Ç –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä—ã

#### internal/models/stats.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞.

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```go
type Stats struct {
    TotalTrades       int              `json:"total_trades"`
    TotalPnl          float64          `json:"total_pnl"`
    TodayTrades       int              `json:"today_trades"`
    TodayPnl          float64          `json:"today_pnl"`
    WeekTrades        int              `json:"week_trades"`
    WeekPnl           float64          `json:"week_pnl"`
    MonthTrades       int              `json:"month_trades"`
    MonthPnl          float64          `json:"month_pnl"`

    StopLossCount     StopLossStats    `json:"stop_loss_stats"`
    LiquidationCount  LiquidationStats `json:"liquidation_stats"`

    TopPairsByTrades  []PairStat       `json:"top_pairs_by_trades"`   // —Ç–æ–ø-5
    TopPairsByProfit  []PairStat       `json:"top_pairs_by_profit"`   // —Ç–æ–ø-5
    TopPairsByLoss    []PairStat       `json:"top_pairs_by_loss"`     // —Ç–æ–ø-5
}

type StopLossStats struct {
    Today  int              `json:"today"`
    Week   int              `json:"week"`
    Month  int              `json:"month"`
    Events []StopLossEvent  `json:"events"`
}

type StopLossEvent struct {
    Symbol    string    `json:"symbol"`
    Exchanges [2]string `json:"exchanges"`
    Timestamp time.Time `json:"timestamp"`
}

type LiquidationStats struct {
    Today  int                 `json:"today"`
    Week   int                 `json:"week"`
    Month  int                 `json:"month"`
    Events []LiquidationEvent  `json:"events"`
}

type LiquidationEvent struct {
    Symbol    string    `json:"symbol"`
    Exchange  string    `json:"exchange"`
    Side      string    `json:"side"`
    Timestamp time.Time `json:"timestamp"`
}

type PairStat struct {
    Symbol string  `json:"symbol"`
    Value  float64 `json:"value"`  // –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫ –∏–ª–∏ PNL
}
```

---

### üìÅ internal/repository/ - –†–∞–±–æ—Ç–∞ —Å –ë–î

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Data Access Layer - –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—è –Ω–∞–¥ –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö.

**–ü—Ä–∏–Ω—Ü–∏–ø:** –ö–∞–∂–¥–∞—è —Å—É—â–Ω–æ—Å—Ç—å –∏–º–µ–µ—Ç —Å–≤–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å CRUD –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏.

#### internal/repository/exchange_repository.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `Create(account *ExchangeAccount) error`
- `GetByID(id int) (*ExchangeAccount, error)`
- `GetByName(name string) (*ExchangeAccount, error)`
- `GetAll() ([]*ExchangeAccount, error)`
- `Update(account *ExchangeAccount) error`
- `Delete(id int) error`
- `UpdateBalance(id int, balance float64) error`

#### internal/repository/pair_repository.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `Create(pair *PairConfig) error`
- `GetByID(id int) (*PairConfig, error)`
- `GetAll() ([]*PairConfig, error)`
- `GetActive() ([]*PairConfig, error)` - —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø–∞—Ä—ã
- `Update(pair *PairConfig) error`
- `Delete(id int) error`
- `UpdateStatus(id int, status string) error`
- `IncrementTrades(id int) error`
- `UpdatePnl(id int, pnl float64) error`

#### internal/repository/order_repository.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `Create(order *OrderRecord) error`
- `GetByID(id int) (*OrderRecord, error)`
- `GetByPairID(pairID int) ([]*OrderRecord, error)`
- `GetRecent(limit int) ([]*OrderRecord, error)`
- –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö –æ—Ä–¥–µ—Ä–æ–≤ –¥–ª—è –∞—É–¥–∏—Ç–∞ –∏ –æ—Ç–ª–∞–¥–∫–∏

#### internal/repository/notification_repository.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `Create(notif *Notification) error`
- `GetRecent(limit int) ([]*Notification, error)`
- `GetByTypes(types []string, limit int) ([]*Notification, error)`
- `DeleteAll() error` - –æ—á–∏—Å—Ç–∫–∞ –∂—É—Ä–Ω–∞–ª–∞
- `DeleteOlderThan(timestamp time.Time) error` - –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö

#### internal/repository/settings_repository.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `Get() (*Settings, error)` - –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –∑–∞–ø–∏—Å—å –Ω–∞—Å—Ç—Ä–æ–µ–∫
- `Update(settings *Settings) error`
- `UpdateNotificationPrefs(prefs NotificationPreferences) error`

#### internal/repository/blacklist_repository.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `Create(entry *BlacklistEntry) error`
- `GetAll() ([]*BlacklistEntry, error)`
- `Delete(symbol string) error`
- `Exists(symbol string) (bool, error)`

#### internal/repository/stats_repository.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `GetStats() (*Stats, error)` - —Ä–∞—Å—á–µ—Ç –∞–≥—Ä–µ–≥–∞—Ç–æ–≤ –∏–∑ —Ç–∞–±–ª–∏—Ü
- `RecordTrade(pairID int, pnl float64, timestamp time.Time) error`
- `RecordStopLoss(event StopLossEvent) error`
- `RecordLiquidation(event LiquidationEvent) error`
- `GetTopPairsByTrades(limit int) ([]PairStat, error)`
- `GetTopPairsByProfit(limit int) ([]PairStat, error)`
- `GetTopPairsByLoss(limit int) ([]PairStat, error)`
- `ResetCounters() error` - —Å–±—Ä–æ—Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

---

### üìÅ internal/service/ - –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Service Layer - –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É repository, bot –∏ API.

#### internal/service/pair_service.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `CreatePair(config PairConfig) error`
  - –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∞–∫—Ç–∏–≤–∞ –Ω–∞ ‚â•2 –±–∏—Ä–∂–∞—Ö
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
- `UpdatePair(id int, config PairConfig) error`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞, –æ—Ç–∫—Ä—ã—Ç–∞ –ª–∏ –ø–æ–∑–∏—Ü–∏—è
  - –ï—Å–ª–∏ –¥–∞ - –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ
  - –ï—Å–ª–∏ –Ω–µ—Ç - –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ
- `DeletePair(id int) error`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –æ—Ç–∫—Ä—ã—Ç—ã—Ö –ø–æ–∑–∏—Ü–∏–π
  - –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –ë–î
- `StartPair(id int) error`
  - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ "active"
  - –°–∏–≥–Ω–∞–ª –±–æ—Ç—É –¥–ª—è –Ω–∞—á–∞–ª–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- `PausePair(id int, forceClose bool) error`
  - –ï—Å–ª–∏ –ø–æ–∑–∏—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ –∏ forceClose=true - –∑–∞–∫—Ä—ã—Ç–∏–µ
  - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –Ω–∞ "paused"
- `GetPairRuntime(id int) (*PairRuntime, error)`
  - –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏–∑ –±–æ—Ç–∞

#### internal/service/exchange_service.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `ConnectExchange(name, apiKey, secret, passphrase string) error`
  - –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –±–∏—Ä–∂–∏ —á–µ—Ä–µ–∑ factory
  - –¢–µ—Å—Ç–æ–≤–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ (–ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–ª—é—á–µ–π)
  - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
- `DisconnectExchange(name string) error`
  - –£–¥–∞–ª–µ–Ω–∏–µ –∫–ª—é—á–µ–π
  - –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–∞—Ä –Ω–∞ —ç—Ç–æ–π –±–∏—Ä–∂–µ
- `UpdateBalance(name string) (float64, error)`
  - –ó–∞–ø—Ä–æ—Å –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ API –±–∏—Ä–∂–∏
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ –ë–î
- `GetAllExchanges() ([]*ExchangeAccount, error)`
  - –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –±–∏—Ä–∂ —Å –∏—Ö —Å—Ç–∞—Ç—É—Å–∞–º–∏

#### internal/service/stats_service.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `GetStats() (*Stats, error)`
  - –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏–∑ –ë–î
  - –†–∞—Å—á–µ—Ç —Ç–æ–ø-5 –ø–∞—Ä
  - –ü–æ–¥—Å—á–µ—Ç —Å–æ–±—ã—Ç–∏–π SL/–ª–∏–∫–≤–∏–¥–∞—Ü–∏–π –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º
- `ResetStats() error`
  - –°–±—Ä–æ—Å —Å—á–µ—Ç—á–∏–∫–æ–≤ (–ø–æ –∑–∞–ø—Ä–æ—Å—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- `RecordTradeCompletion(pairID int, pnl float64) error`
  - –ó–∞–ø–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–π —Å–¥–µ–ª–∫–∏
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–∞—Ä—ã
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

#### internal/service/notification_service.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `CreateNotification(notif Notification) error`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–≤–∫–ª—é—á–µ–Ω –ª–∏ —ç—Ç–æ—Ç —Ç–∏–ø)
  - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
  - Broadcast —á–µ—Ä–µ–∑ WebSocket hub
- `GetNotifications(types []string, limit int) ([]*Notification, error)`
  - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º
  - –í–æ–∑–≤—Ä–∞—Ç –ø–æ—Å–ª–µ–¥–Ω–∏—Ö N
- `ClearNotifications() error`
  - –û—á–∏—Å—Ç–∫–∞ –∂—É—Ä–Ω–∞–ª–∞

#### internal/service/risk_service.go
**–§—É–Ω–∫—Ü–∏–∏:**
- `CheckStopLoss(pairID int, currentPnl float64) (bool, error)`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è SL
  - –í–æ–∑–≤—Ä–∞—Ç true –µ—Å–ª–∏ –Ω—É–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å
- `CheckMarginRequirement(exchange string, symbol string, qty float64) (bool, error)`
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ –º–∞—Ä–∂–∏
  - –†–∞—Å—á–µ—Ç margin requirement
- `HandleLiquidation(pairID int, exchange string, side string) error`
  - –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–±—ã—Ç–∏—è –ª–∏–∫–≤–∏–¥–∞—Ü–∏–∏
  - –ó–∞–∫—Ä—ã—Ç–∏–µ –≤—Ç–æ—Ä–æ–π –Ω–æ–≥–∏
  - –ó–∞–ø–∏—Å—å –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
  - –ü–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä—ã –Ω–∞ –ø–∞—É–∑—É
- `RecordStopLoss(pairID int, exchanges [2]string, symbol string) error`
  - –ó–∞–ø–∏—Å—å —Å–æ–±—ã—Ç–∏—è SL –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

---

### üìÅ internal/config/ - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

#### internal/config/config.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

**–§—É–Ω–∫—Ü–∏–∏:**
- –ß—Ç–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ó–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:

```go
type Config struct {
    Server struct {
        Port     int
        Host     string
        UseHTTPS bool
        CertFile string
        KeyFile  string
    }

    Database struct {
        Driver   string
        Host     string
        Port     int
        Name     string
        User     string
        Password string
        SSLMode  string
    }

    Security struct {
        JWTSecret       string
        EncryptionKey   string  // –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è API –∫–ª—é—á–µ–π
        SessionTimeout  int
    }

    Bot struct {
        UpdateInterval     time.Duration  // —á–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ü–µ–Ω
        BalanceUpdateFreq  time.Duration  // —á–∞—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–æ–≤
        MaxRetries         int
        RetryBackoff       time.Duration
    }

    Logging struct {
        Level  string
        Format string  // json, text
    }
}
```

---

## üìÅ pkg/ - –ü–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

### üìÅ pkg/crypto/ - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ

#### pkg/crypto/encrypt.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

**–§—É–Ω–∫—Ü–∏–∏:**
- `Encrypt(plaintext string, key []byte) (string, error)`
  - AES-256 —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
  - –í–æ–∑–≤—Ä–∞—Ç base64 encoded —Å—Ç—Ä–æ–∫–∏
- `Decrypt(ciphertext string, key []byte) (string, error)`
  - –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞
- `GenerateKey() ([]byte, error)`
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–µ–π –ø–µ—Ä–µ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ –ë–î

#### pkg/crypto/hash.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö.

**–§—É–Ω–∫—Ü–∏–∏:**
- `HashPassword(password string) (string, error)` - bcrypt
- `VerifyPassword(password, hash string) bool`
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

---

### üìÅ pkg/utils/ - –£—Ç–∏–ª–∏—Ç—ã

#### pkg/utils/math.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —É—Ç–∏–ª–∏—Ç—ã.

**–§—É–Ω–∫—Ü–∏–∏:**
- `RoundToLotSize(value, lotSize float64) float64` - –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ –¥–æ lot size –±–∏—Ä–∂–∏
- `CalculateSpread(priceHigh, priceLow float64) float64` - —Ä–∞—Å—á–µ—Ç —Å–ø—Ä–µ–¥–∞
- `CalculateNetSpread(spread, feeA, feeB float64) float64` - —á–∏—Å—Ç—ã–π —Å–ø—Ä–µ–¥ —Å —É—á–µ—Ç–æ–º –∫–æ–º–∏—Å—Å–∏–π
- `CalculateWeightedAverage(prices, volumes []float64) float64` - —Å—Ä–µ–¥–Ω–µ–≤–∑–≤–µ—à–µ–Ω–Ω–∞—è —Ü–µ–Ω–∞

#### pkg/utils/logger.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è.

**–§—É–Ω–∫—Ü–∏–∏:**
- `InitLogger(config LogConfig) *Logger`
- –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ (zap, logrus)
- –£—Ä–æ–≤–Ω–∏: DEBUG, INFO, WARN, ERROR
- –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥-—Ñ–∞–π–ª–æ–≤
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ JSON –¥–ª—è production

#### pkg/utils/time.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º.

**–§—É–Ω–∫—Ü–∏–∏:**
- `GetDayStart(t time.Time) time.Time` - –Ω–∞—á–∞–ª–æ –¥–Ω—è
- `GetWeekStart(t time.Time) time.Time` - –Ω–∞—á–∞–ª–æ –Ω–µ–¥–µ–ª–∏
- `GetMonthStart(t time.Time) time.Time` - –Ω–∞—á–∞–ª–æ –º–µ—Å—è—Ü–∞
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: –∞–≥—Ä–µ–≥–∞—Ü–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –ø–µ—Ä–∏–æ–¥–∞–º

#### pkg/utils/validator.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö.

**–§—É–Ω–∫—Ü–∏–∏:**
- `ValidateSymbol(symbol string) error`
- `ValidateSpread(spread float64) error` - –ø—Ä–æ–≤–µ—Ä–∫–∞ > 0
- `ValidateVolume(volume float64) error` - –ø—Ä–æ–≤–µ—Ä–∫–∞ > 0
- `ValidateNOrders(n int) error` - –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚â• 1

---

### üìÅ pkg/retry/ - Retry –ª–æ–≥–∏–∫–∞

#### pkg/retry/retry.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Retry –º–µ—Ö–∞–Ω–∏–∑–º —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff.

**–§—É–Ω–∫—Ü–∏–∏:**
- `Do(operation func() error, config RetryConfig) error`
  - –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ø–æ–≤—Ç–æ—Ä–∞–º–∏
  - –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞: 2s, 4s, 8s, 16s
  - –ú–∞–∫—Å–∏–º—É–º N –ø–æ–ø—ã—Ç–æ–∫
- `DoWithContext(ctx context.Context, operation func() error, config RetryConfig) error`
  - –° –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π context –¥–ª—è –æ—Ç–º–µ–Ω—ã

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:**
```go
type RetryConfig struct {
    MaxRetries   int
    InitialDelay time.Duration
    MaxDelay     time.Duration
    Multiplier   float64
}
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** –ø–æ–≤—Ç–æ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –±–∏—Ä–∂ –ø—Ä–∏ —Å–µ—Ç–µ–≤—ã—Ö –æ—à–∏–±–∫–∞—Ö.

---

### üìÅ pkg/ratelimit/ - Rate Limiting

#### pkg/ratelimit/limiter.go
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ç—Ä–æ–ª—å —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –±–∏—Ä–∂.

**–§—É–Ω–∫—Ü–∏–∏:**
- `NewRateLimiter(requestsPerSecond int) *RateLimiter`
- `Wait(ctx context.Context) error` - –æ–∂–∏–¥–∞–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –Ω–∞ –∑–∞–ø—Ä–æ—Å
- `Allow() bool` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
- –ê–ª–≥–æ—Ä–∏—Ç–º: Token Bucket –∏–ª–∏ Leaky Bucket

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ –ø—Ä–µ–≤—ã—à–µ–Ω–∏—è rate limits –±–∏—Ä–∂
- –û—Ç–¥–µ–ª—å–Ω—ã–π limiter –¥–ª—è –∫–∞–∂–¥–æ–π –±–∏—Ä–∂–∏
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ª–∏–º–∏—Ç–æ–≤ —Å–æ–≥–ª–∞—Å–Ω–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ –±–∏—Ä–∂

---

## üìÅ migrations/ - –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç:** golang-migrate, goose –∏–ª–∏ –∞–Ω–∞–ª–æ–≥.

**–ü—Ä–∏–º–µ—Ä—ã —Ñ–∞–π–ª–æ–≤:**

### 001_create_exchanges_table.up.sql
```sql
CREATE TABLE exchanges (
    id SERIAL PRIMARY KEY,
    name VARCHAR(50) UNIQUE NOT NULL,
    api_key TEXT NOT NULL,
    secret_key TEXT NOT NULL,
    passphrase TEXT,
    connected BOOLEAN DEFAULT false,
    balance DECIMAL(20, 8) DEFAULT 0,
    last_error TEXT,
    updated_at TIMESTAMP DEFAULT NOW(),
    created_at TIMESTAMP DEFAULT NOW()
);
```

### 002_create_pairs_table.up.sql
```sql
CREATE TABLE pairs (
    id SERIAL PRIMARY KEY,
    symbol VARCHAR(20) NOT NULL,
    base VARCHAR(10) NOT NULL,
    quote VARCHAR(10) NOT NULL,
    entry_spread_pct DECIMAL(10, 4) NOT NULL,
    exit_spread_pct DECIMAL(10, 4) NOT NULL,
    volume_asset DECIMAL(20, 8) NOT NULL,
    n_orders INT DEFAULT 1,
    stop_loss DECIMAL(20, 2),
    status VARCHAR(20) DEFAULT 'paused',
    trades_count INT DEFAULT 0,
    total_pnl DECIMAL(20, 2) DEFAULT 0,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW()
);
```

### 003_create_orders_table.up.sql
```sql
CREATE TABLE orders (
    id SERIAL PRIMARY KEY,
    pair_id INT REFERENCES pairs(id) ON DELETE CASCADE,
    exchange VARCHAR(50) NOT NULL,
    side VARCHAR(10) NOT NULL,
    type VARCHAR(20) DEFAULT 'market',
    part_index INT DEFAULT 0,
    quantity DECIMAL(20, 8) NOT NULL,
    price_avg DECIMAL(20, 8),
    status VARCHAR(20) NOT NULL,
    error_message TEXT,
    created_at TIMESTAMP DEFAULT NOW(),
    filled_at TIMESTAMP
);
```

### 004_create_notifications_table.up.sql
```sql
CREATE TABLE notifications (
    id SERIAL PRIMARY KEY,
    timestamp TIMESTAMP DEFAULT NOW(),
    type VARCHAR(50) NOT NULL,
    severity VARCHAR(10) DEFAULT 'info',
    pair_id INT REFERENCES pairs(id) ON DELETE SET NULL,
    message TEXT NOT NULL,
    meta JSONB
);

CREATE INDEX idx_notifications_timestamp ON notifications(timestamp DESC);
CREATE INDEX idx_notifications_type ON notifications(type);
```

### 005_create_settings_table.up.sql
```sql
CREATE TABLE settings (
    id INT PRIMARY KEY DEFAULT 1,
    consider_funding BOOLEAN DEFAULT false,
    max_concurrent_trades INT,
    notification_prefs JSONB,
    updated_at TIMESTAMP DEFAULT NOW()
);

INSERT INTO settings (id) VALUES (1);
```

### 006_create_blacklist_table.up.sql
```sql
CREATE TABLE blacklist (
    id SERIAL PRIMARY KEY,
    symbol VARCHAR(20) UNIQUE NOT NULL,
    reason TEXT,
    created_at TIMESTAMP DEFAULT NOW()
);
```

### 007_create_trades_table.up.sql
```sql
CREATE TABLE trades (
    id SERIAL PRIMARY KEY,
    pair_id INT REFERENCES pairs(id) ON DELETE CASCADE,
    symbol VARCHAR(20) NOT NULL,
    exchanges VARCHAR(100),  -- "bybit,okx"
    entry_time TIMESTAMP NOT NULL,
    exit_time TIMESTAMP NOT NULL,
    pnl DECIMAL(20, 2) NOT NULL,
    was_stop_loss BOOLEAN DEFAULT false,
    was_liquidation BOOLEAN DEFAULT false,
    created_at TIMESTAMP DEFAULT NOW()
);

CREATE INDEX idx_trades_exit_time ON trades(exit_time DESC);
CREATE INDEX idx_trades_pair_id ON trades(pair_id);
```

---

## üìÅ frontend/ - React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º.

**–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏:**
- React 18+
- TypeScript
- WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
- Axios –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- Styled-components –∏–ª–∏ Tailwind CSS
- React Router –¥–ª—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```
frontend/
‚îú‚îÄ‚îÄ public/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Bot/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PairCard.tsx          # –∫–∞—Ä—Ç–æ—á–∫–∞ —Ç–æ—Ä–≥–æ–≤–æ–π –ø–∞—Ä—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AddPairModal.tsx      # –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EditPairModal.tsx     # —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Blacklist.tsx         # —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ API/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ExchangeList.tsx      # —Å–ø–∏—Å–æ–∫ –±–∏—Ä–∂
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ExchangeCard.tsx      # –∫–∞—Ä—Ç–æ—á–∫–∞ –±–∏—Ä–∂–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Stats/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StatsOverview.tsx     # –æ–±–∑–æ—Ä —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TopPairs.tsx          # —Ç–æ–ø-5 –ø–∞—Ä
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ EventsList.tsx        # —Å–ø–∏—Å–æ–∫ SL/–ª–∏–∫–≤–∏–¥–∞—Ü–∏–π
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Notifications/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ NotificationFeed.tsx  # –ª–µ–Ω—Ç–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ NotificationFilters.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ Common/
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Header.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Navigation.tsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ BalanceBar.tsx        # –±–∞–ª–∞–Ω—Å—ã –±–∏—Ä–∂
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BotPage.tsx               # –≤–∫–ª–∞–¥–∫–∞ –ë–û–¢
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ APIStatsPage.tsx          # –≤–∫–ª–∞–¥–∫–∞ API/STATS
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ NotificationsPage.tsx     # –≤–∫–ª–∞–¥–∫–∞ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api.ts                    # HTTP –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ websocket.ts              # WebSocket –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ usePairs.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useExchanges.ts
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useWebSocket.ts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useNotifications.ts
‚îÇ   ‚îú‚îÄ‚îÄ types/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts                  # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx
‚îÇ   ‚îî‚îÄ‚îÄ index.tsx
‚îú‚îÄ‚îÄ package.json
‚îî‚îÄ‚îÄ tsconfig.json
```

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –≤–∫–ª–∞–¥–æ–∫:**

### –í–∫–ª–∞–¥–∫–∞ –ë–û–¢ (BotPage.tsx)
- –ë–∞–ª–∞–Ω—Å—ã –±–∏—Ä–∂ –≤–≤–µ—Ä—Ö—É
- –ö–Ω–æ–ø–∫–∞ "–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä—É"
- –°–µ—Ç–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ –ø–∞—Ä (3 –≤ —Ä—è–¥)
- –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è (–∑–µ–ª—ë–Ω—ã–π/–æ—Ä–∞–Ω–∂–µ–≤—ã–π/–±–µ–ª—ã–π)
- –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è: –°—Ç–∞—Ä—Ç/–ü–∞—É–∑–∞, –ò–∑–º–µ–Ω–∏—Ç—å, –£–¥–∞–ª–∏—Ç—å
- –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤–Ω–∏–∑—É

### –í–∫–ª–∞–¥–∫–∞ API/STATS (APIStatsPage.tsx)
**–°–µ–∫—Ü–∏—è API:**
- –°–ø–∏—Å–æ–∫ 6 –±–∏—Ä–∂ —Å –ª–æ–≥–æ—Ç–∏–ø–∞–º–∏
- –ü–æ–ª—è –¥–ª—è API –∫–ª—é—á–µ–π
- –ö–Ω–æ–ø–∫–∏ –ü–æ–¥–∫–ª—é—á–∏—Ç—å/–û—Ç–∫–ª—é—á–∏—Ç—å/–ò–∑–º–µ–Ω–∏—Ç—å
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞

**–°–µ–∫—Ü–∏—è STATS:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–µ–ª–æ–∫ (–¥–µ–Ω—å/–Ω–µ–¥–µ–ª—è/–º–µ—Å—è—Ü)
- –û–±—â–∏–π PNL (–¥–µ–Ω—å/–Ω–µ–¥–µ–ª—è/–º–µ—Å—è—Ü)
- –°—á–µ—Ç—á–∏–∫ SL (—Å –¥–µ—Ç–∞–ª—è–º–∏)
- –°—á–µ—Ç—á–∏–∫ –ª–∏–∫–≤–∏–¥–∞—Ü–∏–π (—Å –¥–µ—Ç–∞–ª—è–º–∏)
- –¢–æ–ø-5 –ø–∞—Ä –ø–æ —Å–¥–µ–ª–∫–∞–º/–ø—Ä–∏–±—ã–ª–∏/—É–±—ã—Ç–∫–∞–º

### –í–∫–ª–∞–¥–∫–∞ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è (NotificationsPage.tsx)
- –ß–µ–∫–±–æ–∫—Å—ã —Ñ–∏–ª—å—Ç—Ä–æ–≤ –ø–æ —Ç–∏–ø–∞–º —Å–æ–±—ã—Ç–∏–π
- –õ–µ–Ω—Ç–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100)
- –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è (–∑–µ–ª—ë–Ω—ã–π/–∂—ë–ª—Ç—ã–π/–∫—Ä–∞—Å–Ω—ã–π)
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ—Ç–º–µ—Ç–∫–∏
- –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å –∂—É—Ä–Ω–∞–ª"

---

## üìÑ –ö–æ—Ä–Ω–µ–≤—ã–µ —Ñ–∞–π–ª—ã

### docker-compose.yml
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ä–∫–µ—Å—Ç—Ä–∞—Ü–∏—è Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤.

**–°–µ—Ä–≤–∏—Å—ã:**
- **app** - Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (backend)
- **db** - PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- **frontend** - React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (dev server –∏–ª–∏ nginx)
- **nginx** - reverse proxy (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –¥–ª—è production)

```yaml
version: '3.8'

services:
  db:
    image: postgres:15
    environment:
      POSTGRES_DB: arbitrage
      POSTGRES_USER: user
      POSTGRES_PASSWORD: password
    volumes:
      - postgres_data:/var/lib/postgresql/data
    ports:
      - "5432:5432"

  app:
    build: .
    depends_on:
      - db
    environment:
      DB_HOST: db
      DB_PORT: 5432
      DB_NAME: arbitrage
      DB_USER: user
      DB_PASSWORD: password
    ports:
      - "8080:8080"
    volumes:
      - ./migrations:/migrations

  frontend:
    build: ./frontend
    ports:
      - "3000:3000"
    depends_on:
      - app

volumes:
  postgres_data:
```

### Dockerfile
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞ –¥–ª—è Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

```dockerfile
FROM golang:1.21-alpine AS builder

WORKDIR /app

COPY go.mod go.sum ./
RUN go mod download

COPY . .
RUN go build -o /arbitrage ./cmd/server

FROM alpine:latest

WORKDIR /root/

COPY --from=builder /arbitrage .
COPY --from=builder /app/migrations ./migrations

EXPOSE 8080

CMD ["./arbitrage"]
```

### go.mod
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Go –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- `github.com/gin-gonic/gin` –∏–ª–∏ `github.com/gorilla/mux` - HTTP router
- `github.com/gorilla/websocket` - WebSocket
- `github.com/lib/pq` - PostgreSQL driver
- `github.com/golang-migrate/migrate` - –º–∏–≥—Ä–∞—Ü–∏–∏
- `github.com/dgrijalva/jwt-go` - JWT auth
- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å API –±–∏—Ä–∂

### go.sum
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ã–µ —Å—É–º–º—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Å–±–æ—Ä–∫–∏.

---

## –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã

### 1. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (Separation of Concerns)
- **cmd/** - —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞
- **internal/api/** - HTTP/WebSocket
- **internal/bot/** - —Ç–æ—Ä–≥–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
- **internal/exchange/** - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –±–∏—Ä–∂–∞–º–∏
- **internal/models/** - —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö
- **internal/repository/** - —Ä–∞–±–æ—Ç–∞ —Å –ë–î
- **internal/service/** - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞

### 2. –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å
- –ö–∞–∂–¥–∞—è –±–∏—Ä–∂–∞ - –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π –æ–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –õ–µ–≥–∫–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –±–∏—Ä–∂
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### 3. –†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –ø–æ–¥–º–µ–Ω—è—Ç—å —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- Service layer –∏–∑–æ–ª–∏—Ä—É–µ—Ç –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –æ—Ç –¥–µ—Ç–∞–ª–µ–π API
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —è–¥—Ä–∞

### 4. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ API –∫–ª—é—á–µ–π (pkg/crypto/)
- Middleware –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
- HTTPS –¥–ª—è production
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### 5. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- WebSocket –¥–ª—è real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π (–º–∏–Ω–∏–º—É–º –∑–∞–¥–µ—Ä–∂–∫–∏)
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –±–∏—Ä–∂–∞–º
- Rate limiting –¥–ª—è —Å–æ–±–ª—é–¥–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π API
- Retry logic —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff

### 6. –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö –æ—à–∏–±–æ–∫
- Recovery –ø–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ (bot/recovery.go)
- Graceful shutdown
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–±—ã—Ç–∏–π
- State machine –¥–ª—è —á–µ—Ç–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏

### 7. –¢–µ—Å—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å
- –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å mock –æ–±—ä–µ–∫—Ç—ã
- Repository –ø–∞—Ç—Ç–µ—Ä–Ω —É–ø—Ä–æ—â–∞–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–π –ë–î
- Service layer —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç API –∏ –ë–î

---

## –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –±–∏—Ä–∂–∏
```
Frontend ‚Üí API Handler ‚Üí Exchange Service ‚Üí Crypto (—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ) ‚Üí Repository ‚Üí DB
                                ‚Üì
                        Test Connection (Exchange API)
                                ‚Üì
                        WebSocket Hub (broadcast balanceUpdate)
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—ã
```
Frontend ‚Üí API Handler ‚Üí Pair Service ‚Üí Validator ‚Üí Repository ‚Üí DB
                              ‚Üì
                        Check availability on ‚â•2 exchanges
                              ‚Üì
                        WebSocket Hub (broadcast pairUpdate)
```

### 3. –¶–∏–∫–ª –∞—Ä–±–∏—Ç—Ä–∞–∂–∞
```
Bot Engine (loop –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É):
    ‚Üì
For each active pair:
    ‚Üì
Spread Calculator ‚Üí Exchange APIs (get prices/orderbooks)
    ‚Üì
Arbitrage Logic ‚Üí Check conditions
    ‚Üì
If entry conditions met:
    ‚Üì
Order Executor ‚Üí Place orders on both exchanges (parallel)
    ‚Üì
Position Monitor ‚Üí Track PNL, spread
    ‚Üì
Risk Manager ‚Üí Check SL, liquidations
    ‚Üì
If exit conditions met:
    ‚Üì
Order Executor ‚Üí Close positions
    ‚Üì
Stats Service ‚Üí Record trade
    ‚Üì
Notification Service ‚Üí Create notification ‚Üí WebSocket Hub ‚Üí Frontend
```

### 4. Real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```
Bot Engine (–∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É):
    ‚Üì
For each pair with open position:
    ‚Üì
Calculate current PNL, spread
    ‚Üì
WebSocket Hub ‚Üí Broadcast pairUpdate ‚Üí Frontend (update card)
```

### 5. –û–±—Ä–∞–±–æ—Ç–∫–∞ Stop Loss
```
Risk Manager ‚Üí Detect PNL ‚â§ -SL
    ‚Üì
Order Executor ‚Üí Close both positions immediately
    ‚Üì
Pair Service ‚Üí Set status = "paused"
    ‚Üì
Stats Service ‚Üí Record SL event
    ‚Üì
Notification Service ‚Üí Create SL notification
    ‚Üì
WebSocket Hub ‚Üí Broadcast to Frontend
```

---

## –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:
1. **exchanges** - –∞–∫–∫–∞—É–Ω—Ç—ã –±–∏—Ä–∂
2. **pairs** - –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –ø–∞—Ä
3. **orders** - –∏—Å—Ç–æ—Ä–∏—è –æ—Ä–¥–µ—Ä–æ–≤
4. **notifications** - –∂—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π
5. **settings** - –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
6. **blacklist** - —á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø–∞—Ä
7. **trades** - –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –∞—Ä–±–∏—Ç—Ä–∞–∂–∏ (–¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏)

### –°–≤—è–∑–∏:
- `pairs.id` ‚Üê `orders.pair_id` (one-to-many)
- `pairs.id` ‚Üê `notifications.pair_id` (one-to-many)
- `pairs.id` ‚Üê `trades.pair_id` (one-to-many)

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)
```bash
# Server
SERVER_PORT=8080
SERVER_HOST=0.0.0.0
USE_HTTPS=false

# Database
DB_DRIVER=postgres
DB_HOST=localhost
DB_PORT=5432
DB_NAME=arbitrage
DB_USER=user
DB_PASSWORD=password
DB_SSL_MODE=disable

# Security
JWT_SECRET=your-secret-key
ENCRYPTION_KEY=32-byte-key-for-aes-256

# Bot
UPDATE_INTERVAL=1s
BALANCE_UPDATE_FREQ=1m
MAX_RETRIES=4
RETRY_BACKOFF=2s

# Logging
LOG_LEVEL=info
LOG_FORMAT=json
```

### –ó–∞–ø—É—Å–∫ –≤ production
```bash
# 1. –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
docker-compose build

# 2. –ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π
docker-compose run app ./arbitrage migrate up

# 3. –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–æ–≤
docker-compose up -d

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker-compose logs -f app
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–î–∞–Ω–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç:

‚úÖ **–ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å** - –ª–µ–≥–∫–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –±–∏—Ä–∂ –∏ —Ñ—É–Ω–∫—Ü–∏–π
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π, –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è, HTTPS
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å, WebSocket, –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫, recovery, state machine
‚úÖ **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø–æ–¥ SaaS
‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º–æ—Å—Ç—å** - —á–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–ª–æ–µ–≤, –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –∏ –≥–æ—Ç–æ–≤–∞ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏.
